{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";import React,{Component}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import FlatList from\"react-native-web/dist/exports/FlatList\";import RefreshControl from\"react-native-web/dist/exports/RefreshControl\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import{SQLite}from'expo-sqlite';var db=SQLite.openDatabase('db.db');import Event_compo from\"../History_components/Event_compo\";import{load_events}from\"../models/all_models\";import{TouchableOpacity}from'react-native-gesture-handler';import{cookies}from\"../Settings\";var Events_tab_data=function(_Component){_inherits(Events_tab_data,_Component);function Events_tab_data(props){var _this;_classCallCheck(this,Events_tab_data);_this=_possibleConstructorReturn(this,_getPrototypeOf(Events_tab_data).call(this,props));_this.componentDidMount=function _callee(){return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.props.navigation.addListener('willFocus',function(route){_this._onRefresh();});case 1:case\"end\":return _context.stop();}}});};_this.process_data=function(rows){_this.setState({events_data:[].concat(_toConsumableArray(_this.state.events_data),_toConsumableArray(rows)),loadingmore:false});console.log(_this.state.events_data);};_this.get_data=function _callee2(limit){return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(cookies.then(function(obj){var data=JSON.parse(obj);_this.setState({user_id:data.user_id});}));case 2:_context2.next=4;return _regeneratorRuntime.awrap(load_events(limit,_this.state.user_id).then(function(response){var event_data=JSON.parse(response);console.log(event_data);_this.process_data(event_data.event_list_all);}));case 4:case\"end\":return _context2.stop();}}});};_this._onRefresh=function(){_this.setState({isRefreshing:true});_this.setState({events_data:[]});_this.setState({limit:0});_this.get_data(0);_this.setState({isRefreshing:false});_this.setState({loadmore_test:' '});};_this.handleLoadMore=function(){_this.setState({loadmore_test:'Loading...'});var limit=parseInt(_this.state.limit)+parseInt(20);_this.setState({limit:limit});_this.get_data(limit);_this.setState({loadmore_test:'Scroll down to load more'});};_this.state={events_data:[],loadmore_test:'',isRefreshing:false,loadingmore:false,history_array:[],limit:0,user_id:null};return _this;}_createClass(Events_tab_data,[{key:\"render\",value:function render(){return React.createElement(View,{style:styles.container},this.state.loadingmore&&React.createElement(ActivityIndicator,{animating:this.state.loadingmore,size:\"large\",color:\"red\"}),React.createElement(FlatList,{numColumns:1,data:this.state.events_data,refreshControl:React.createElement(RefreshControl,{refreshing:this.state.isRefreshing,onRefresh:this._onRefresh.bind(this)}),keyExtractor:function keyExtractor(item,index){return index.toString();},onEndReachedThreshold:3,onEndReached:this.handleLoadMore.bind(this),renderItem:function renderItem(_ref){var item=_ref.item,index=_ref.index;return React.createElement(View,null,React.createElement(TouchableOpacity,null,React.createElement(Event_compo,{event_name:item.event_name,city:item.city})));}}),React.createElement(View,null,React.createElement(Text,null,this.state.loadmore_test)));}}]);return Events_tab_data;}(Component);export{Events_tab_data as default};var styles=StyleSheet.create({container:{flex:1,justifyContent:'center',alignItems:'center',backgroundColor:'#fff'},heading:{fontSize:22,color:\"#000000\",marginTop:10,width:100,marginBottom:20,fontWeight:\"bold\"}});","map":{"version":3,"sources":["D:/Notes_app/Pages/history_tabs/Events_tab_data.js"],"names":["React","Component","SQLite","db","openDatabase","Event_compo","load_events","TouchableOpacity","cookies","Events_tab_data","props","componentDidMount","navigation","addListener","route","_onRefresh","process_data","rows","setState","events_data","state","loadingmore","console","log","get_data","limit","then","obj","data","JSON","parse","user_id","response","event_data","event_list_all","isRefreshing","loadmore_test","handleLoadMore","parseInt","history_array","styles","container","bind","item","index","toString","event_name","city","StyleSheet","create","flex","justifyContent","alignItems","backgroundColor","heading","fontSize","color","marginTop","width","marginBottom","fontWeight"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { View, Text, StyleSheet, FlatList, RefreshControl, ActivityIndicator } from 'react-native';\r\n\r\nimport { SQLite } from 'expo-sqlite';\r\nconst db = SQLite.openDatabase('db.db');\r\nimport Event_compo from '../History_components/Event_compo';\r\nimport { load_events } from '../models/all_models';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport { cookies } from '../Settings';\r\n \r\n\r\nexport default class Events_tab_data extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            events_data: [],\r\n            loadmore_test: '',\r\n            isRefreshing: false,\r\n            loadingmore: false,\r\n            history_array: [],\r\n            limit: 0,\r\n            user_id:null\r\n        };\r\n    }\r\n\r\n    componentDidMount =async()=> {\r\n        // this.get_data(this.state.limit);\r\n        this.props.navigation.addListener('willFocus', (route) => {\r\n            this._onRefresh();\r\n        });\r\n\r\n     \r\n\r\n    }\r\n\r\n    process_data = (rows) => {\r\n\r\n        this.setState({\r\n            events_data: [...this.state.events_data, ...rows],\r\n            loadingmore: false\r\n        })\r\n\r\n        console.log(this.state.events_data);\r\n    }\r\n\r\n    get_data = async(limit) => { \r\n       \r\n        await cookies.then((obj)  => {\r\n            var data =     JSON.parse(obj);  \r\n            this.setState({\r\n                user_id:data.user_id\r\n            })   \r\n         }); \r\n       await load_events(limit,this.state.user_id).then((response) => {  \r\n            var event_data   = JSON.parse(response);\r\n            console.log(event_data);\r\n            this.process_data(event_data.event_list_all)\r\n          \r\n        }); \r\n\r\n    }\r\n\r\n    _onRefresh = () => {\r\n        this.setState({ isRefreshing: true })\r\n        this.setState({ events_data: [] })\r\n        this.setState({ limit: 0 })\r\n        this.get_data(0);\r\n        this.setState({ isRefreshing: false })\r\n        this.setState({ loadmore_test: ' ', });\r\n    }\r\n\r\n    ///// LOAD MORE ////////////////////\r\n    handleLoadMore = () => {\r\n\r\n        this.setState({ loadmore_test: 'Loading...', });\r\n        var limit = parseInt(this.state.limit) + parseInt(20);  // increase page by 1\r\n        this.setState({ limit: limit });\r\n        this.get_data(limit);  // method for API call \r\n        this.setState({ loadmore_test: 'Scroll down to load more', });\r\n\r\n    };\r\n\r\n \r\n    render() {\r\n        return (\r\n            <View style={styles.container}>\r\n\r\n                {this.state.loadingmore &&\r\n                    <ActivityIndicator animating={this.state.loadingmore} size=\"large\" color=\"red\" />\r\n                }\r\n                <FlatList\r\n                    numColumns={1}\r\n                    data={this.state.events_data}\r\n                    refreshControl={\r\n                        <RefreshControl\r\n                            refreshing={this.state.isRefreshing}\r\n                            onRefresh={this._onRefresh.bind(this)}\r\n                        />\r\n                    }\r\n                    keyExtractor={(item, index) => index.toString()}\r\n                    onEndReachedThreshold={3}\r\n                    onEndReached={this.handleLoadMore.bind(this)}\r\n                    renderItem={({ item, index }) => (\r\n\r\n\r\n\r\n                        <View>\r\n                            <TouchableOpacity>\r\n                                 <Event_compo event_name={item.event_name} city={item.city} />\r\n                            </TouchableOpacity>\r\n                        </View>\r\n\r\n                    )}\r\n                />\r\n\r\n                <View>\r\n                    <Text>{this.state.loadmore_test}</Text>\r\n                </View>\r\n\r\n\r\n            </View>\r\n\r\n        );\r\n    }\r\n\r\n}\r\n// define your styles\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        backgroundColor: '#fff',\r\n\r\n\r\n    },\r\n    heading: {\r\n        fontSize: 22,\r\n        color: \"#000000\",\r\n        marginTop: 10,\r\n        width: 100,\r\n        marginBottom: 20,\r\n        fontWeight: \"bold\"\r\n    }\r\n});"]},"metadata":{},"sourceType":"module"}