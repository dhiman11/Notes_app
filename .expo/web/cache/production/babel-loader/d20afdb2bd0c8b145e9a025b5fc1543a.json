{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";var _MediaTypeInput;import uuidv4 from'uuid/v4';import{MediaTypeOptions}from\"./ImagePicker.types\";var MediaTypeInput=(_MediaTypeInput={},_defineProperty(_MediaTypeInput,MediaTypeOptions.All,'video/mp4,video/quicktime,video/x-m4v,video/*,image/*'),_defineProperty(_MediaTypeInput,MediaTypeOptions.Images,'image/*'),_defineProperty(_MediaTypeInput,MediaTypeOptions.Videos,'video/mp4,video/quicktime,video/x-m4v,video/*'),_MediaTypeInput);export default{get name(){return'ExponentImagePicker';},launchImageLibraryAsync:function launchImageLibraryAsync(_ref){var _ref$mediaTypes,mediaTypes,_ref$allowsMultipleSe,allowsMultipleSelection;return _regeneratorRuntime.async(function launchImageLibraryAsync$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref$mediaTypes=_ref.mediaTypes,mediaTypes=_ref$mediaTypes===void 0?MediaTypeOptions.All:_ref$mediaTypes,_ref$allowsMultipleSe=_ref.allowsMultipleSelection,allowsMultipleSelection=_ref$allowsMultipleSe===void 0?false:_ref$allowsMultipleSe;_context.next=3;return _regeneratorRuntime.awrap(openFileBrowserAsync({mediaTypes:mediaTypes,allowsMultipleSelection:allowsMultipleSelection}));case 3:return _context.abrupt(\"return\",_context.sent);case 4:case\"end\":return _context.stop();}}});},launchCameraAsync:function launchCameraAsync(_ref2){var _ref2$mediaTypes,mediaTypes,_ref2$allowsMultipleS,allowsMultipleSelection;return _regeneratorRuntime.async(function launchCameraAsync$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref2$mediaTypes=_ref2.mediaTypes,mediaTypes=_ref2$mediaTypes===void 0?MediaTypeOptions.All:_ref2$mediaTypes,_ref2$allowsMultipleS=_ref2.allowsMultipleSelection,allowsMultipleSelection=_ref2$allowsMultipleS===void 0?false:_ref2$allowsMultipleS;_context2.next=3;return _regeneratorRuntime.awrap(openFileBrowserAsync({mediaTypes:mediaTypes,allowsMultipleSelection:allowsMultipleSelection,capture:true}));case 3:return _context2.abrupt(\"return\",_context2.sent);case 4:case\"end\":return _context2.stop();}}});}};function openFileBrowserAsync(_ref3){var mediaTypes=_ref3.mediaTypes,_ref3$capture=_ref3.capture,capture=_ref3$capture===void 0?false:_ref3$capture,_ref3$allowsMultipleS=_ref3.allowsMultipleSelection,allowsMultipleSelection=_ref3$allowsMultipleS===void 0?false:_ref3$allowsMultipleS;var mediaTypeFormat=MediaTypeInput[mediaTypes];var input=document.createElement('input');input.style.display='none';input.setAttribute('type','file');input.setAttribute('accept',mediaTypeFormat);input.setAttribute('id',uuidv4());if(allowsMultipleSelection){input.setAttribute('multiple','multiple');}if(capture){input.setAttribute('capture','camera');}document.body.appendChild(input);return new Promise(function(resolve,reject){input.addEventListener('change',function(){if(input.files){var targetFile=input.files[0];var reader=new FileReader();reader.onerror=function(){reject('Failed to read the selected media because the operation failed.');};reader.onload=function(_ref4){var target=_ref4.target;var uri=target.result;resolve({cancelled:false,uri:uri,width:0,height:0});};reader.readAsDataURL(targetFile);}else{resolve({cancelled:true});}document.body.removeChild(input);});var event=new MouseEvent('click');input.dispatchEvent(event);});}","map":{"version":3,"sources":["../src/ImagePicker/ExponentImagePicker.web.ts"],"names":[],"mappings":"mJAAA,MAAO,CAAA,MAAP,KAAmB,SAAnB,CAEA,OAEE,gBAFF,2BAOA,GAAM,CAAA,cAAc,qDACjB,gBAAgB,CAAC,GADA,CACM,uDADN,kCAEjB,gBAAgB,CAAC,MAFA,CAES,SAFT,kCAGjB,gBAAgB,CAAC,MAHA,CAGS,+CAHT,kBAApB,CAMA,cAAe,CACb,GAAI,CAAA,IAAJ,EAAQ,CACN,MAAO,qBAAP,CACD,CAHY,CAIP,uBAJO,2QAKX,UALW,CAKX,UALW,0BAKE,gBAAgB,CAAC,GALnB,4CAMX,uBANW,CAMX,uBANW,gCAMe,KANf,wEAQE,oBAAoB,CAAC,CAChC,UAAU,CAAV,UADgC,CAEhC,uBAAuB,CAAvB,uBAFgC,CAAD,CARtB,uGAaP,iBAbO,sQAcX,UAdW,CAcX,UAdW,2BAcE,gBAAgB,CAAC,GAdnB,8CAeX,uBAfW,CAeX,uBAfW,gCAee,KAff,yEAiBE,oBAAoB,CAAC,CAChC,UAAU,CAAV,UADgC,CAEhC,uBAAuB,CAAvB,uBAFgC,CAGhC,OAAO,CAAE,IAHuB,CAAD,CAjBtB,0GAAf,CAyBA,QAAS,CAAA,oBAAT,OAIyB,IAHvB,CAAA,UAGuB,OAHvB,UAGuB,qBAFvB,OAEuB,CAFvB,OAEuB,wBAFb,KAEa,2CADvB,uBACuB,CADvB,uBACuB,gCADG,KACH,uBACvB,GAAM,CAAA,eAAe,CAAG,cAAc,CAAC,UAAD,CAAtC,CAEA,GAAM,CAAA,KAAK,CAAG,QAAQ,CAAC,aAAT,CAAuB,OAAvB,CAAd,CACA,KAAK,CAAC,KAAN,CAAY,OAAZ,CAAsB,MAAtB,CACA,KAAK,CAAC,YAAN,CAAmB,MAAnB,CAA2B,MAA3B,EACA,KAAK,CAAC,YAAN,CAAmB,QAAnB,CAA6B,eAA7B,EACA,KAAK,CAAC,YAAN,CAAmB,IAAnB,CAAyB,MAAM,EAA/B,EACA,GAAI,uBAAJ,CAA6B,CAC3B,KAAK,CAAC,YAAN,CAAmB,UAAnB,CAA+B,UAA/B,EACD,CACD,GAAI,OAAJ,CAAa,CACX,KAAK,CAAC,YAAN,CAAmB,SAAnB,CAA8B,QAA9B,EACD,CACD,QAAQ,CAAC,IAAT,CAAc,WAAd,CAA0B,KAA1B,EAEA,MAAO,IAAI,CAAA,OAAJ,CAAY,SAAC,OAAD,CAAU,MAAV,CAAoB,CACrC,KAAK,CAAC,gBAAN,CAAuB,QAAvB,CAAiC,UAAK,CACpC,GAAI,KAAK,CAAC,KAAV,CAAiB,CACf,GAAM,CAAA,UAAU,CAAG,KAAK,CAAC,KAAN,CAAY,CAAZ,CAAnB,CACA,GAAM,CAAA,MAAM,CAAG,GAAI,CAAA,UAAJ,EAAf,CACA,MAAM,CAAC,OAAP,CAAiB,UAAK,CACpB,MAAM,CAAC,iEAAD,CAAN,CACD,CAFD,CAGA,MAAM,CAAC,MAAP,CAAgB,eAAe,IAAZ,CAAA,MAAY,OAAZ,MAAY,CAC7B,GAAM,CAAA,GAAG,CAAI,MAAc,CAAC,MAA5B,CACA,OAAO,CAAC,CACN,SAAS,CAAE,KADL,CAEN,GAAG,CAAH,GAFM,CAGN,KAAK,CAAE,CAHD,CAIN,MAAM,CAAE,CAJF,CAAD,CAAP,CAMD,CARD,CAUA,MAAM,CAAC,aAAP,CAAqB,UAArB,EACD,CAjBD,IAiBO,CACL,OAAO,CAAC,CAAE,SAAS,CAAE,IAAb,CAAD,CAAP,CACD,CAED,QAAQ,CAAC,IAAT,CAAc,WAAd,CAA0B,KAA1B,EACD,CAvBD,EAyBA,GAAM,CAAA,KAAK,CAAG,GAAI,CAAA,UAAJ,CAAe,OAAf,CAAd,CACA,KAAK,CAAC,aAAN,CAAoB,KAApB,EACD,CA5BM,CAAP,CA6BD","sourcesContent":["import uuidv4 from 'uuid/v4';\n\nimport {\n  ImagePickerResult,\n  MediaTypeOptions,\n  OpenFileBrowserOptions,\n  ImagePickerOptions,\n} from './ImagePicker.types';\n\nconst MediaTypeInput = {\n  [MediaTypeOptions.All]: 'video/mp4,video/quicktime,video/x-m4v,video/*,image/*',\n  [MediaTypeOptions.Images]: 'image/*',\n  [MediaTypeOptions.Videos]: 'video/mp4,video/quicktime,video/x-m4v,video/*',\n};\n\nexport default {\n  get name(): string {\n    return 'ExponentImagePicker';\n  },\n  async launchImageLibraryAsync({\n    mediaTypes = MediaTypeOptions.All,\n    allowsMultipleSelection = false,\n  }: ImagePickerOptions): Promise<ImagePickerResult> {\n    return await openFileBrowserAsync({\n      mediaTypes,\n      allowsMultipleSelection,\n    });\n  },\n  async launchCameraAsync({\n    mediaTypes = MediaTypeOptions.All,\n    allowsMultipleSelection = false,\n  }: ImagePickerOptions): Promise<ImagePickerResult> {\n    return await openFileBrowserAsync({\n      mediaTypes,\n      allowsMultipleSelection,\n      capture: true,\n    });\n  },\n};\n\nfunction openFileBrowserAsync({\n  mediaTypes,\n  capture = false,\n  allowsMultipleSelection = false,\n}: OpenFileBrowserOptions): Promise<ImagePickerResult> {\n  const mediaTypeFormat = MediaTypeInput[mediaTypes];\n\n  const input = document.createElement('input');\n  input.style.display = 'none';\n  input.setAttribute('type', 'file');\n  input.setAttribute('accept', mediaTypeFormat);\n  input.setAttribute('id', uuidv4());\n  if (allowsMultipleSelection) {\n    input.setAttribute('multiple', 'multiple');\n  }\n  if (capture) {\n    input.setAttribute('capture', 'camera');\n  }\n  document.body.appendChild(input);\n\n  return new Promise((resolve, reject) => {\n    input.addEventListener('change', () => {\n      if (input.files) {\n        const targetFile = input.files[0];\n        const reader = new FileReader();\n        reader.onerror = () => {\n          reject('Failed to read the selected media because the operation failed.');\n        };\n        reader.onload = ({ target }) => {\n          const uri = (target as any).result;\n          resolve({\n            cancelled: false,\n            uri,\n            width: 0,\n            height: 0,\n          });\n        };\n        // Read in the image file as a binary string.\n        reader.readAsDataURL(targetFile);\n      } else {\n        resolve({ cancelled: true });\n      }\n\n      document.body.removeChild(input);\n    });\n\n    const event = new MouseEvent('click');\n    input.dispatchEvent(event);\n  });\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}