{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";import React,{Component}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TextInput from\"react-native-web/dist/exports/TextInput\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import AsyncStorage from\"react-native-web/dist/exports/AsyncStorage\";import Image from\"react-native-web/dist/exports/Image\";import{Entypo,MaterialCommunityIcons}from'@expo/vector-icons';import{TouchableOpacity}from'react-native-gesture-handler';import{save_user_detailss,save_user_image,get_user_data,get_cookie_data}from\"./models/all_models\";import*as Permissions from'expo-permissions';import*as ImagePicker from'expo-image-picker';import{api_name,cookies}from\"./Settings\";var User=function(_Component){_inherits(User,_Component);function User(props){var _this;_classCallCheck(this,User);_this=_possibleConstructorReturn(this,_getPrototypeOf(User).call(this,props));_this.componentDidMount=function _callee(){var value,data;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(AsyncStorage.getItem('cookies'));case 2:value=_context.sent;_context.next=5;return _regeneratorRuntime.awrap(JSON.parse(value));case 5:data=_context.sent;_context.next=8;return _regeneratorRuntime.awrap(_this.setState({user_id:data['user_id']}));case 8:_context.next=10;return _regeneratorRuntime.awrap(_this.get_data(data['user_id']));case 10:_this.props.navigation.addListener('willFocus',function(route){_this.get_data(data['user_id']);});case 11:case\"end\":return _context.stop();}}});};_this.process_data=function _callee2(rows,type){return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(type==\"user\"){_this.setState({full_name:rows.full_name,email:rows.email,wechat:rows.wechat_name,phone:rows.phone,profile_picture:rows.profile_pic});}case 1:case\"end\":return _context2.stop();}}});};_this.get_data=function _callee3(user_id){return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(get_user_data(user_id).then(function(response){var user_data=JSON.parse(response);_this.process_data(user_data,'user');}));case 2:case\"end\":return _context3.stop();}}});};_this.choose_images=function _callee4(user_id){var _await$Permissions$as,status,result;return _regeneratorRuntime.async(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA_ROLL));case 2:_await$Permissions$as=_context4.sent;status=_await$Permissions$as.status;if(status=='granted'){}else{}_context4.next=7;return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({allowsEditing:true,aspect:[4,3],base64:true,quality:0.5}).then(function(response){if(response.base64){var image=response.base64;save_user_image(image,user_id).then(function(response){if(response){_this.get_data(user_id);}});}}));case 7:result=_context4.sent;case 8:case\"end\":return _context4.stop();}}});};_this.save_user=function(user_id){var full_name=_this.state.full_name;var email=_this.state.email;var wechat=_this.state.wechat;var phone=_this.state.phone;var new_password=_this.state.new_password;save_user_detailss(full_name,email,wechat,phone,new_password,user_id).then(function(response){response=JSON.parse(response);console.log(response);if(response.result){_this.setState({update_response:\"Updated successfully\"});}else{_this.setState({update_response:\"No changes Found\"});}});};_this.state={user_id:\"\",base64_image:'',full_name:'',user_name:'',email:'',wechat:'',phone:'',update_response:'',new_password:'',profile_picture:api_name+\"assets/users_images/no_image.jpg\",request_token:''};return _this;}_createClass(User,[{key:\"log_out\",value:function log_out(key){try{AsyncStorage.clear();this.props.screenProps.navigate(\"Auth\");}catch(error){alert('Login failed');}}},{key:\"render\",value:function render(){var _this2=this;return React.createElement(ScrollView,null,React.createElement(View,{style:{height:200,backgroundColor:\"#2e75b6\",marginBottom:80}},React.createElement(Text,{style:styles.user_name},this.state.full_name),React.createElement(View,{style:styles.user_frame},React.createElement(TouchableOpacity,{onPress:function onPress(){return _this2.choose_images(_this2.state.user_id);}},React.createElement(Image,{style:styles.image_settings,source:{uri:this.state.profile_picture,cache:'force-cache'}}))),React.createElement(View,{style:{position:\"absolute\",right:10,top:10}},React.createElement(TouchableOpacity,{onPress:function onPress(){return _this2.log_out('cookies');}},React.createElement(Entypo,{style:styles.inputIcon,name:\"log-out\",size:34,color:\"#fff\"})))),React.createElement(View,{style:styles.searchSection},React.createElement(Entypo,{style:styles.inputIcon,name:\"user\",size:25,color:\"#656565\"}),React.createElement(TextInput,{style:styles.input,placeholder:\"Name\",value:this.state.full_name,onChangeText:function onChangeText(searchString){_this2.setState({full_name:searchString});},underlineColorAndroid:\"transparent\"})),React.createElement(View,{style:styles.searchSection},React.createElement(Entypo,{style:styles.inputIcon,name:\"email\",size:25,color:\"#656565\"}),React.createElement(TextInput,{style:styles.input,placeholder:\"User Email\",value:this.state.email,onChangeText:function onChangeText(searchString){_this2.setState({email:searchString});},underlineColorAndroid:\"transparent\"})),React.createElement(View,{style:styles.searchSection},React.createElement(MaterialCommunityIcons,{style:styles.inputIcon,name:\"wechat\",size:25,color:\"#656565\"}),React.createElement(TextInput,{style:styles.input,value:this.state.wechat,placeholder:\"User Wechat\",onChangeText:function onChangeText(searchString){_this2.setState({wechat:searchString});},underlineColorAndroid:\"transparent\"})),React.createElement(View,{style:styles.searchSection},React.createElement(MaterialCommunityIcons,{style:styles.inputIcon,name:\"cellphone\",size:25,color:\"#656565\"}),React.createElement(TextInput,{style:styles.input,placeholder:\"User Phone\",value:this.state.phone,onChangeText:function onChangeText(searchString){_this2.setState({phone:searchString});},underlineColorAndroid:\"transparent\"})),React.createElement(View,{style:styles.searchSection},React.createElement(MaterialCommunityIcons,{style:styles.inputIcon,name:\"textbox-password\",size:25,color:\"#656565\"}),React.createElement(TextInput,{style:styles.input,placeholder:\"New Password (Leave empty if don't want to change)\",onChangeText:function onChangeText(searchString){_this2.setState({new_password:searchString});},underlineColorAndroid:\"transparent\"})),React.createElement(View,null,React.createElement(Text,{style:{color:\"red\",marginTop:10,marginLeft:10}},this.state.update_response)),React.createElement(View,{style:{alignSelf:'flex-end',backgroundColor:\"#2e75b6\",height:40,marginTop:20,paddingTop:9,width:100,fontSize:15,textAlign:\"center\",paddingLeft:25,marginRight:10}},React.createElement(TouchableOpacity,{onPress:function onPress(){return _this2.save_user(_this2.state.user_id);}},React.createElement(Text,{style:{color:\"#fff\"}},\"Update\"))));}}]);return User;}(Component);export{User as default};var styles=StyleSheet.create({user_name:{alignItems:\"center\",alignContent:\"center\",fontSize:25,color:\"#fff\",textAlign:\"center\",paddingTop:80},user_frame:{height:120,left:\"37%\",marginBottom:100,width:120,backgroundColor:\"#fff\",position:\"absolute\",top:150,zIndex:999,borderRadius:60,borderWidth:2,borderColor:\"#2e75b6\"},searchSection:{flex:1,height:60,flexDirection:'row',justifyContent:'center',alignItems:'center',backgroundColor:'#fff',borderBottomWidth:1,borderBottomColor:\"#a7a7a7\"},inputIcon:{paddingLeft:20},input:{flex:1,minHeight:40,zIndex:100,paddingLeft:20,backgroundColor:'#fff',color:'#424242'},image_settings:{width:116,height:116,borderBottomWidth:1,borderRadius:60}});","map":{"version":3,"sources":["D:/Notes_app/Pages/User.js"],"names":["React","Component","Entypo","MaterialCommunityIcons","TouchableOpacity","save_user_detailss","save_user_image","get_user_data","get_cookie_data","Permissions","ImagePicker","api_name","cookies","User","props","componentDidMount","AsyncStorage","getItem","value","JSON","parse","data","setState","user_id","get_data","navigation","addListener","route","process_data","rows","type","full_name","email","wechat","wechat_name","phone","profile_picture","profile_pic","then","response","user_data","choose_images","askAsync","CAMERA_ROLL","status","launchImageLibraryAsync","allowsEditing","aspect","base64","quality","image","result","save_user","state","new_password","console","log","update_response","base64_image","user_name","request_token","key","clear","screenProps","navigate","error","alert","height","backgroundColor","marginBottom","styles","user_frame","image_settings","uri","cache","position","right","top","log_out","inputIcon","searchSection","input","searchString","color","marginTop","marginLeft","alignSelf","paddingTop","width","fontSize","textAlign","paddingLeft","marginRight","StyleSheet","create","alignItems","alignContent","left","zIndex","borderRadius","borderWidth","borderColor","flex","flexDirection","justifyContent","borderBottomWidth","borderBottomColor","minHeight"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { View, Text, StyleSheet, TextInput, ScrollView, AsyncStorage, Image } from 'react-native';\r\nimport { Entypo, MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport { save_user_detailss,save_user_image, get_user_data,get_cookie_data } from './models/all_models';\r\nimport * as Permissions from 'expo-permissions';\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport { api_name,cookies } from './Settings';\r\n\r\n\r\n\r\nexport default class User extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            user_id:\"\",\r\n            base64_image: '',\r\n            full_name: '',\r\n            user_name: '',\r\n            email: '',\r\n            wechat: '',\r\n            phone: '',\r\n            update_response: '',\r\n            new_password: '',\r\n            profile_picture: api_name+\"assets/users_images/no_image.jpg\",\r\n            request_token: ''\r\n\r\n        };\r\n \r\n\r\n\r\n\r\n    }\r\n\r\n    componentDidMount = async () => {\r\n       const value = await AsyncStorage.getItem('cookies');\r\n       const data = await JSON.parse(value);  \r\n      \r\n       await this.setState({\r\n        user_id:data['user_id']\r\n       })\r\n       await this.get_data(data['user_id']);\r\n        \r\n        this.props.navigation.addListener('willFocus', (route) => {\r\n            this.get_data(data['user_id']);\r\n        });\r\n    }\r\n\r\n\r\n\r\n\r\n    process_data = async (rows, type) => {\r\n\r\n        if (type == \"user\") {\r\n\r\n            this.setState({\r\n                full_name: rows.full_name, \r\n                email: rows.email,\r\n                wechat: rows.wechat_name,\r\n                phone: rows.phone,\r\n                profile_picture: rows.profile_pic,\r\n            });\r\n\r\n           \r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    get_data = async (user_id) => {\r\n\r\n        await get_user_data(user_id).then((response) => {  \r\n            var user_data = JSON.parse(response);\r\n            this.process_data(user_data, 'user')\r\n        });\r\n\r\n    }\r\n\r\n    log_out(key) {\r\n\r\n    \r\n\r\n       \r\n        try {\r\n            AsyncStorage.clear();\r\n            this.props.screenProps.navigate(\"Auth\"); \r\n        } catch (error) {\r\n            alert('Login failed');\r\n        }\r\n        // return new Promise((resolve, reject) => {\r\n        //     AsyncStorage.removeItem(key, (err, response) => {\r\n        //         if (response) {\r\n        //             resolve(response);\r\n                   \r\n        //             this.props.screenProps.navigate('Auth');\r\n        //             // this.props.navigation.navigate('Auth');\r\n        //         } else {\r\n        //             reject(err);\r\n        //         }\r\n        //     });\r\n        // })\r\n\r\n    }\r\n\r\n\r\n\r\n    choose_images = async (user_id) => {\r\n        const { status } = await Permissions.askAsync(Permissions.CAMERA_ROLL);\r\n        if (status == 'granted') {\r\n            // alert('Sorry, we need camera roll permissions to make this work!');\r\n            // alert(status)\r\n        } else {\r\n            // alert(status)\r\n        }\r\n        let result = await ImagePicker.launchImageLibraryAsync({\r\n            allowsEditing: true,\r\n            aspect: [4, 3],\r\n            base64: true,\r\n            quality: 0.5\r\n        }).then((response) => {\r\n            \r\n            if(response.base64){\r\n                var image = response.base64; \r\n                save_user_image(image, user_id).then((response) => {\r\n                    if(response){\r\n                       this.get_data(user_id);\r\n                    }\r\n                });\r\n            }\r\n      \r\n        });\r\n\r\n        // if(result.base64){\r\n        //     this.setState({\r\n        //         base64_image: result.base64\r\n        //     });\r\n        // }else{ \r\n        // }  \r\n        // result.base64\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n\r\n    save_user = (user_id) => {\r\n\r\n        let full_name = this.state.full_name;\r\n        let email = this.state.email;\r\n        let wechat = this.state.wechat; \r\n        let phone = this.state.phone;\r\n        let new_password = this.state.new_password;\r\n \r\n   \r\n        save_user_detailss(full_name,email,wechat,phone,new_password,user_id).then((response) =>{ \r\n            \r\n            response = JSON.parse(response);\r\n            console.log(response);\r\n            \r\n            if(response.result){\r\n                this.setState({\r\n                    update_response: \"Updated successfully\"\r\n                })\r\n          } else{\r\n                this.setState({\r\n                    update_response: \"No changes Found\"\r\n                })\r\n          }\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    render() {\r\n        return (\r\n            <ScrollView>\r\n                <View style={{ height: 200, backgroundColor: \"#2e75b6\", marginBottom: 80 }}>\r\n                    <Text style={styles.user_name}>{this.state.full_name}</Text>\r\n\r\n\r\n                    <View style={styles.user_frame} >\r\n                        <TouchableOpacity onPress={() => this.choose_images(this.state.user_id)}>\r\n                            <Image\r\n                               \r\n                                style={styles.image_settings}\r\n                                source={{  \r\n                                    uri: this.state.profile_picture,\r\n                                    cache: 'force-cache'\r\n                                 }}\r\n                            />\r\n                        </TouchableOpacity>\r\n                    </View>\r\n\r\n                    <View style={{ position: \"absolute\", right: 10, top: 10 }}>\r\n                        <TouchableOpacity onPress={() => this.log_out('cookies')}>\r\n                            <Entypo style={styles.inputIcon} name=\"log-out\" size={34} color=\"#fff\" />\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                </View>\r\n\r\n                <View style={styles.searchSection}>\r\n                    <Entypo style={styles.inputIcon} name=\"user\" size={25} color=\"#656565\" />\r\n                    <TextInput\r\n                        style={styles.input}\r\n                        placeholder=\"Name\"\r\n                        value={this.state.full_name}\r\n                        onChangeText={(searchString) => { this.setState({ full_name:searchString }) }}\r\n                        underlineColorAndroid=\"transparent\"\r\n                    />\r\n                </View>\r\n\r\n                <View style={styles.searchSection}>\r\n                    <Entypo style={styles.inputIcon} name=\"email\" size={25} color=\"#656565\" />\r\n                    <TextInput\r\n                        style={styles.input}\r\n                        placeholder=\"User Email\"\r\n                        value={this.state.email}\r\n                        onChangeText={(searchString) => { this.setState({ email:searchString }) }}\r\n                        underlineColorAndroid=\"transparent\"\r\n                    />\r\n                </View>\r\n                <View style={styles.searchSection}>\r\n                    <MaterialCommunityIcons style={styles.inputIcon} name=\"wechat\" size={25} color=\"#656565\" />\r\n                    <TextInput\r\n                        style={styles.input}\r\n                        value={this.state.wechat}\r\n                        placeholder=\"User Wechat\"\r\n                        onChangeText={(searchString) => { this.setState({ wechat:searchString }) }}\r\n                        underlineColorAndroid=\"transparent\"\r\n                    />\r\n                </View>\r\n\r\n                <View style={styles.searchSection}>\r\n                    <MaterialCommunityIcons style={styles.inputIcon} name=\"cellphone\" size={25} color=\"#656565\" />\r\n                    <TextInput\r\n                        style={styles.input}\r\n                        placeholder=\"User Phone\"\r\n                        value={this.state.phone}\r\n                        onChangeText={(searchString) => { this.setState({ phone:searchString }) }}\r\n                        underlineColorAndroid=\"transparent\"\r\n                    />\r\n                </View>\r\n\r\n                <View style={styles.searchSection}>\r\n                    <MaterialCommunityIcons style={styles.inputIcon} name=\"textbox-password\" size={25} color=\"#656565\" />\r\n                    <TextInput\r\n                        style={styles.input}\r\n                        placeholder=\"New Password (Leave empty if don't want to change)\"\r\n                        onChangeText={(searchString) => { this.setState({ new_password:searchString }) }}\r\n                        underlineColorAndroid=\"transparent\"\r\n                    />\r\n                </View>\r\n                <View>\r\n                                <Text style={{color:\"red\",marginTop:10,marginLeft:10 }} >{this.state.update_response}</Text>\r\n                </View>\r\n\r\n                <View style={{ alignSelf: 'flex-end', backgroundColor: \"#2e75b6\", height: 40, marginTop: 20, paddingTop: 9, width: 100, fontSize: 15, textAlign: \"center\", paddingLeft: 25, marginRight: 10 }}>\r\n                    <TouchableOpacity onPress={() => this.save_user(this.state.user_id)}>\r\n                        <Text style={{ color: \"#fff\" }}>Update</Text>\r\n                    </TouchableOpacity>\r\n                </View>\r\n\r\n            </ScrollView>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nconst styles =\r\n    StyleSheet.create({\r\n        user_name: {\r\n            alignItems: \"center\",\r\n            alignContent: \"center\",\r\n            fontSize: 25, color: \"#fff\",\r\n            textAlign: \"center\",\r\n            paddingTop: 80\r\n        },\r\n        user_frame: {\r\n            height: 120,\r\n            left: \"37%\",\r\n            marginBottom: 100,\r\n            width: 120,\r\n            backgroundColor: \"#fff\",\r\n            position: \"absolute\",\r\n            top: 150,\r\n            zIndex: 999,\r\n            borderRadius: 60,\r\n            borderWidth: 2,\r\n            borderColor: \"#2e75b6\"\r\n        },\r\n        searchSection: {\r\n            flex: 1,\r\n            height: 60,\r\n            flexDirection: 'row',\r\n            justifyContent: 'center',\r\n            alignItems: 'center',\r\n            backgroundColor: '#fff',\r\n            borderBottomWidth: 1,\r\n            borderBottomColor: \"#a7a7a7\"\r\n        },\r\n        inputIcon: {\r\n            paddingLeft: 20,\r\n        },\r\n        input: {\r\n            flex: 1,\r\n            minHeight: 40,\r\n            zIndex: 100,\r\n            paddingLeft: 20,\r\n            backgroundColor: '#fff',\r\n            color: '#424242',\r\n        },\r\n        image_settings:\r\n        { \r\n            width: 116,\r\n            height: 116,\r\n            borderBottomWidth: 1,\r\n            borderRadius: 60,\r\n        }\r\n\r\n    });\r\n"]},"metadata":{},"sourceType":"module"}